<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML Cleaner Tool</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 2rem;
      background-color: #f4f4f4;
      color: #333;
    }
    h1 {
      color: #2c3e50;
      text-align: center;
    }
    textarea {
      width: 100%;
      height: 200px;
      margin-bottom: 1rem;
      padding: 1rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      resize: vertical;
    }
    button {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      margin-right: 1rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #cleanBtn {
      background-color: #3498db;
      color: white;
    }
    #copyBtn {
      background-color: #2ecc71;
      color: white;
    }
    #output {
      background-color: #fff;
      padding: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      white-space: pre-wrap;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>HTML Cleaner Tool</h1>
  <textarea id="input" placeholder="Paste your messy HTML or marked text here..."></textarea>
  <br>
  <button id="cleanBtn">Clean HTML</button>
  <button id="copyBtn">Copy Output</button>
  <pre id="output"></pre>

  <script>
    const cleanBtn = document.getElementById('cleanBtn');
    const copyBtn = document.getElementById('copyBtn');
    const input = document.getElementById('input');
    const output = document.getElementById('output');

    function cleanHTML(rawHtml) {
      // Create DOM parser
      const temp = document.createElement('div');
      temp.innerHTML = rawHtml;

      // Remove unwanted tags and attributes
      const removeTags = ['div', 'section'];
      const walker = document.createTreeWalker(temp, NodeFilter.SHOW_ELEMENT);

      let node;
      while ((node = walker.nextNode())) {
        // Remove inline styles and classes
        node.removeAttribute('style');
        node.removeAttribute('class');
        node.removeAttribute('id');
        node.removeAttribute('data-sf-element');
        node.removeAttribute('data-placeholder-label');

        // Flatten removable tags by replacing them with their children
        if (removeTags.includes(node.tagName.toLowerCase())) {
          while (node.firstChild) {
            node.parentNode.insertBefore(node.firstChild, node);
          }
          node.remove();
        }

        // Heading cleanup
        if (/^H[1-6]$/.test(node.tagName)) {
          const text = node.textContent.replace(/\(h\d+\)\s*/i, '').trim();
          node.textContent = text;
        }
      }

      // Create cleaned HTML
      let result = '';
      temp.childNodes.forEach(el => {
        if (el.nodeType === Node.ELEMENT_NODE) {
          result += formatElement(el);
        } else if (el.nodeType === Node.TEXT_NODE && el.textContent.trim()) {
          result += `<p>${el.textContent.trim()}</p>\n`;
        }
      });

      return result.trim();
    }

    function formatElement(el) {
      const tag = el.tagName.toLowerCase();
      if (['h1', 'h2', 'h3', 'h4', 'h5', 'h6'].includes(tag)) {
        return `<${tag}>${el.textContent.trim()}</${tag}>\n`;
      } else if (tag === 'p') {
        return `<p>${el.textContent.trim()}</p>\n`;
      } else if (tag === 'a') {
        const href = el.getAttribute('href') || '#';
        return `<a href="${href}">${el.textContent.trim()}</a>`;
      } else if (tag === 'strong' || tag === 'b') {
        return `<strong>${el.textContent.trim()}</strong>`;
      } else if (tag === 'em' || tag === 'i') {
        return `<em>${el.textContent.trim()}</em>`;
      }
      return '';
    }

    cleanBtn.addEventListener('click', () => {
      const cleaned = cleanHTML(input.value);
      output.textContent = cleaned;
    });

    copyBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(output.textContent).then(() => {
        copyBtn.textContent = 'Copied!';
        setTimeout(() => copyBtn.textContent = 'Copy Output', 2000);
      });
    });
  </script>
</body>
</html>
